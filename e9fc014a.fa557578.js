(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{169:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return p})),t.d(n,"metadata",(function(){return l})),t.d(n,"toc",(function(){return i})),t.d(n,"default",(function(){return u}));var a=t(3),r=t(7),o=(t(0),t(179)),p={id:"tensorflow-setup",title:"How to setup Memgraph TensorFlow Op?",sidebar_label:"TensorFlow Op"},l={unversionedId:"database-functionalities/tensorflow-setup",id:"database-functionalities/tensorflow-setup",isDocsHomePage:!1,title:"How to setup Memgraph TensorFlow Op?",description:"TensorFlow is an open-source software",source:"@site/docs/database-functionalities/tensorflow-setup.md",slug:"/database-functionalities/tensorflow-setup",permalink:"/memgraph/database-functionalities/tensorflow-setup",editUrl:"https://github.com/memgraph/docs/tree/master/docs/database-functionalities/tensorflow-setup.md",version:"current",sidebar_label:"TensorFlow Op",sidebar:"memgraph",previous:{title:"Profiling queries",permalink:"/memgraph/database-functionalities/profiling-queries"},next:{title:"Making a backup",permalink:"/memgraph/reference-guide/backup"}},i=[{value:"Memgraph Tensorflow Op usage",id:"memgraph-tensorflow-op-usage",children:[{value:"Example",id:"example",children:[]}]},{value:"Memgraph Parallel Tensorflow Op Usage",id:"memgraph-parallel-tensorflow-op-usage",children:[{value:"Example",id:"example-1",children:[]}]},{value:"Where to next?",id:"where-to-next",children:[]}],s={toc:i};function u(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(o.a)("wrapper",Object(a.a)({},s,t,{components:n,mdxType:"MDXLayout"}),Object(o.a)("p",null,Object(o.a)("a",{parentName:"p",href:"https://www.tensorflow.org/"},"TensorFlow")," is an open-source software\nlibrary for high-performance numerical computation.\nA TensorFlow op (operation) is a fundamental building block of all TensorFlow\nmodels."),Object(o.a)("p",null,"Memgraph TensorFlow op wraps the high-performance Memgraph client for\nuse with TensorFlow, allowing natural data transfer between Memgraph and\nTensorFlow at any point in the model."),Object(o.a)("p",null,"At this point, we strongly advise you to read\nthe TensorFlow section of our\n",Object(o.a)("a",{parentName:"p",href:"/memgraph/reference-guide/tensorflow"},"Reference guide"),"."),Object(o.a)("p",null,"In this article, we assume you have installed Python 3 and the TensorFlow pip\npackage. See the ",Object(o.a)("a",{parentName:"p",href:"https://www.tensorflow.org/install/pip?lang=python3"},"link")," for\nmore information.\nWe also assume that you have installed and are running Memgraph (",Object(o.a)("a",{parentName:"p",href:"/memgraph/getting-started/installation"},"see more"),")"),Object(o.a)("h2",{id:"memgraph-tensorflow-op-usage"},"Memgraph Tensorflow Op usage"),Object(o.a)("p",null,"Memgraph TensorFlow op is a shared library (",Object(o.a)("inlineCode",{parentName:"p"},".so")," file).\nLibrary name is ",Object(o.a)("inlineCode",{parentName:"p"},"libmemgraph_op.so"),"."),Object(o.a)("p",null,"Load op library:"),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-python"},"import tensorflow as tf\nmemgraph_op_module = tf.load_op_library('libmemgraph_op.so')\n")),Object(o.a)("p",null,"Create Memgraph TensorFlow op:"),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-python"},"# Create Memgraph op, and put placeholders for input\nmemgraph_op = memgraph_op_module.memgraph_op(query_holder,\n                                             input_list_holder,\n                                             output_dtype=tf.int64)\n")),Object(o.a)("p",null,"Where ",Object(o.a)("inlineCode",{parentName:"p"},"query_holder")," and ",Object(o.a)("inlineCode",{parentName:"p"},"input_list_holder"),"\nare TensorFlow placeholders."),Object(o.a)("p",null,"Computation:"),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-python"},"# Run Memgraph op\noutput = sess.run(memgraph_op, {query_holder: query,\n                                input_list_holder: input_list})\n")),Object(o.a)("p",null,"The output is a tuple, where the first element is the header and the second\nelement is a result matrix."),Object(o.a)("h3",{id:"example"},"Example"),Object(o.a)("p",null,"Here is a simple example. You can use\n",Object(o.a)("a",{parentName:"p",href:"/memgraph/tutorials/movie-recommendation"},"the movie dataset")," or you can use\nthis simple dataset:"),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-cypher"},"CREATE (:User {id: 1})-[:Rating {score:5.0}]->(:Movie {id: 1});\nCREATE (:User {id: 2})-[:Rating {score:2.5}]->(:Movie {id: 3});\nCREATE (:User {id: 3})-[:Rating {score:4.5}]->(:Movie {id: 8});\nCREATE (:User {id: 4})-[:Rating {score:1.0}]->(:Movie {id: 12});\nCREATE (:User {id: 5})-[:Rating {score:4.5}]->(:Movie {id: 33});\nCREATE (:User {id: 42})-[:Rating {score:1.0}]->(:Movie {id: 42});\n")),Object(o.a)("p",null,"This example assumes that Memgraph is running on ",Object(o.a)("inlineCode",{parentName:"p"},"127.0.0.1:7687"),"\nwithout ",Object(o.a)("inlineCode",{parentName:"p"},"ssl"),".\nIf you want to change this,\nuse op ",Object(o.a)("a",{parentName:"p",href:"/memgraph/reference-guide/tensorflow"},"attributes"),"."),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-python"},'import tensorflow as tf\n\n# Load libmemgraph_op.so\nmemgraph_op_module = tf.load_op_library(\'libmemgraph_op.so\')\n\n\ndef main():\n    query = """match (u :User)--\x3e(m :Movie)\n              where u.id in $input_list\n              return u.id, m.id;"""\n\n    # Input list used in query\n    input_list = [1, 2, 3, 4, 5]\n\n    # Create tensorflow session\n    with tf.Session() as sess:\n\n        # Query placeholder\n        query_holder = tf.placeholder(tf.string)\n\n        # Input list placeholder\n        input_list_holder = tf.placeholder(tf.int64)\n\n        # Create Memgraph op, and put placeholders for input\n        memgraph_op = memgraph_op_module.memgraph_op(query_holder,\n                                                     input_list_holder,\n                                                     output_dtype=tf.int64)\n\n        # Run Memgraph op\n        output = sess.run(memgraph_op, {query_holder: query,\n                                        input_list_holder: input_list})\n\n        # First output is list of headers\n        print("Headers:")\n        for i in output[0]:\n            print(i)\n\n        # Output matrix (rows), query results\n        print("Rows: ")\n        for i in output[1]:\n            print(i)\n\nif __name__ == "__main__":\n    main()\n')),Object(o.a)("h2",{id:"memgraph-parallel-tensorflow-op-usage"},"Memgraph Parallel Tensorflow Op Usage"),Object(o.a)("p",null,"Load op library:"),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-python"},"import tensorflow as tf\nmemgraph_op_module = tf.load_op_library('libmemgraph_op.so')\n")),Object(o.a)("p",null,"Create Memgraph TensorFlow op:"),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-python"},"# Create Memgraph op, and put placeholders for input\nmemgraph_op = memgraph_op_module.parallel_memgraph_op(query_holder,\n                                                      input_list_holder,\n                                                      output_dtype=tf.int64,\n                                                      num_workers=4)\n")),Object(o.a)("p",null,"Where ",Object(o.a)("inlineCode",{parentName:"p"},"query_holder")," and ",Object(o.a)("inlineCode",{parentName:"p"},"input_list_holder"),"\nare TensorFlow placeholders."),Object(o.a)("p",null,"Computation:"),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-python"},"# Run Memgraph op\noutput = sess.run(memgraph_op, {query_holder: query,\n                                input_list_holder: input_list})\n")),Object(o.a)("p",null,"The output is a tuple, where the first element is the header and the second\nelement is a result matrix."),Object(o.a)("h3",{id:"example-1"},"Example"),Object(o.a)("p",null,"This example shows one of the archetypal patterns of using the parallel op.\nWe will find nodes by ids and return each of their features."),Object(o.a)("p",null,"We will query this example dataset:"),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-cypher"},"CREATE (n:Node {id: 1, features: [100, 115, 121, 95, 72, 142]});\nCREATE (n:Node {id: 2, features: [45, 125, 212, 46, 25, 92]});\nCREATE (n:Node {id: 3, features: [34, 74, 261, 194, 142, 37]});\nCREATE (n:Node {id: 4, features: [76, 92, 11, 16, 78, 261]});\nCREATE (n:Node {id: 5, features: [175, 63, 111, 192, 58, 91]});\nCREATE (n:Node {id: 6, features: [251, 184, 43, 57, 243, 231]});\nCREATE (n:Node {id: 7, features: [187, 136, 37, 33, 76, 145]});\nCREATE (n:Node {id: 8, features: [193, 195, 200, 74, 28, 127]});\n")),Object(o.a)("p",null,"This example assumes that Memgraph is running on ",Object(o.a)("inlineCode",{parentName:"p"},"127.0.0.1:7687"),"\nwithout ",Object(o.a)("inlineCode",{parentName:"p"},"ssl"),".\nIf you want to change this,\nuse op ",Object(o.a)("a",{parentName:"p",href:"/memgraph/reference-guide/tensorflow"},"attributes"),"."),Object(o.a)("pre",null,Object(o.a)("code",{parentName:"pre",className:"language-python"},'import tensorflow as tf\n\n# Load libmemgraph_op.so\nmemgraph_op_module = tf.load_op_library(\'libmemgraph_op.so\')\n\n\ndef main():\n    query = """\n            UNWIND $input_list AS idx\n            MATCH (n:Node {id: idx})\n            RETURN n.features\n            """\n\n    # Input list used in query\n    input_list = [1, 2, 3, 4, 5]\n\n    # Create tensorflow session\n    with tf.Session() as sess:\n\n        # Query placeholder\n        query_holder = tf.placeholder(tf.string)\n\n        # Input list placeholder\n        input_list_holder = tf.placeholder(tf.int64)\n\n        # Create Memgraph op, and put placeholders for input\n        memgraph_op = memgraph_op_module.parallel_memgraph_op(query_holder,\n                                                     input_list_holder,\n                                                     output_dtype=tf.int64)\n\n        # Run Memgraph op\n        output = sess.run(memgraph_op, {query_holder: query,\n                                        input_list_holder: input_list})\n\n        # First output is list of headers\n        print("Headers:")\n        for i in output[0]:\n            print(i)\n\n        # Output matrix (rows), query results\n        print("Rows: ")\n        for i in output[1]:\n            print(i)\n\nif __name__ == "__main__":\n    main()\n')),Object(o.a)("h2",{id:"where-to-next"},"Where to next?"),Object(o.a)("p",null,"To learn more about Memgraph's functionalities, visit the ",Object(o.a)("strong",{parentName:"p"},Object(o.a)("a",{parentName:"strong",href:"../reference-guide"},"Reference guide")),".\nFor real-world examples of how to use Memgraph, we strongly suggest going through one of the available ",Object(o.a)("strong",{parentName:"p"},Object(o.a)("a",{parentName:"strong",href:"/memgraph/tutorials/tutorials"},"Tutorials")),"."))}u.isMDXComponent=!0},179:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=t(0),r=t.n(a);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=r.a.createContext({}),u=function(e){var n=r.a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},c=r.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),c=u(t),d=a,h=c["".concat(p,".").concat(d)]||c[d]||m[d]||o;return t?r.a.createElement(h,l(l({ref:n},s),{},{components:t})):r.a.createElement(h,l({ref:n},s))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,p=new Array(o);p[0]=c;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l.mdxType="string"==typeof e?e:a,p[1]=l;for(var s=2;s<o;s++)p[s]=t[s];return r.a.createElement.apply(null,p)}return r.a.createElement.apply(null,t)}c.displayName="MDXCreateElement"}}]);